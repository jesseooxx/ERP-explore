# T 模組研究 - 開發上下文

**最後更新**: 2025-12-22
**狀態**: 研究完成，可繼續深入

---

## 本次會話完成的工作

### 1. 清理廠商專屬表格
- 從 `完整表格字典_backup - 複製.txt` 中刪除了 30 個廠商專屬表格
- 移除的廠商: 彬松、建信、開利耐特、賀寶芙、泰茂、聰仲、添鼎、巨瀚、攝揚、鉅茂、技高、一廷、揚生、耀億、韶陽

### 2. 建立表格編號分類指南
- 檔案: `research/表格編號分類指南.md`
- 內容: 模組首碼(e/f/k/o/p/q/s/t)、子模組碼(am/bm/cm...)、數字規則

### 3. 深度研究 T 模組連動關係
派出 5 個 Agent 同時研究:
- Agent 1: tdm01~26 (產品) 表格結構
- Agent 2: tem01~17 (報價) 表格結構
- Agent 3: tfm01~12 (訂單) 表格結構
- Agent 4: trs01~tmp (Excel匯入) 機制
- Agent 5: 資料庫結構定義搜尋

### 4. 建立完整分析文件
- 檔案: `research/T模組連動關係完整分析.md`
- 內容: 連動架構圖、主外鍵關係、BOM計算公式、Excel匯入流程

---

## 關鍵發現

### 核心表格結構 (已驗證)

| 表格 | 主鍵 | 說明 |
|------|------|------|
| tdm05 | (de01, de02) | 產品標準 BOM，19 個欄位 |
| tem05 | (ee011, ee02, ee03) | 訂單專屬 BOM |
| tfm01 | fa01 | 訂單主檔 |
| tfm02 | (fb01, fb02) | 訂單明細 |
| tfm03 | (fc01, fc02, fc031, fc04) | 出貨排程 |
| tfm04 | (fd01, fd02, fd03) | 排程彙總 |

### BOM 計算公式
```
組件需求 = 訂購數量 × (de03 / de04)
```

### 連動流程
```
tdm05 (標準BOM)
  → 建立訂單時複製到 tem05
  → 訂單轉採購時計算組件需求
  → 生成採購單 tgm01/02
```

### Excel 匯入機制
- trs01: 匯入配置 (目標表格、規則名稱)
- trs02: 上傳記錄 (文件名、時間、狀態)
- trs03: 欄位映射 (Excel Col → DB Column)
- trs_tmp: 驗證暫存

**確認系統有內建 Excel 匯入功能**

---

## 已建立的文件

| 檔案路徑 | 內容 |
|----------|------|
| `research/表格編號分類指南.md` | 全模組命名規則 |
| `research/T模組連動關係完整分析.md` | 產品/報價/訂單連動 |
| `research/完整表格字典_backup - 複製.txt` | 清理後的表格字典 |

---

## 下一步可進行的工作

1. **連接正式環境驗證**
   - 連接 192.168.252.16/datawin
   - 查詢 INFORMATION_SCHEMA 取得完整 schema
   - 驗證 tdm01~04, tdm06~26 的具體欄位

2. **實作測試**
   - 使用已知的 SQL 腳本測試 BOM 計算
   - 測試 Excel 匯入流程

3. **其他模組研究**
   - K 模組 (國內庫存銷售)
   - P 模組 (生產管理)
   - F 模組 (財務會計)

---

## 未完成的工作

**無未完成工作** - 本次研究任務已完成

---

## 重要文件位置

```
C:\真桌面\Claude code\ERP explore\
├── docs\
│   ├── tfm01_tfm02_欄位說明.md      # 訂單欄位完整定義
│   ├── tdm05_產品標準BOM對照表.md   # BOM 欄位定義
│   └── 完整資料表關聯圖.md          # 表格關聯圖
├── research\
│   ├── 表格編號分類指南.md          # 模組命名規則
│   ├── T模組連動關係完整分析.md     # 本次研究成果
│   └── 完整表格字典_backup - 複製.txt
└── sql\
    ├── create_product_bom.sql       # BOM 建立範例
    └── calculate_bom_quantities.sql # 需求計算範例
```
